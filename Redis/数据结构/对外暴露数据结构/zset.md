## <h3 id="redis_data_structure_5">有序集合对象(zset)</h3>
> - Sorted set 相比 set 多了一个权重参数score，集合中的元素能够按score进行排列。可以做排行榜应用，取TOP N操作。另外，sorted set可以用来做延时任务。最后一个应用就是可以做范围查找。
> - 有序集合的编码可以是ziplist和skiplist之一。
### 1 底层实现
### 1.1 ziplist编码 
- ziplist编码的有序集合对象底层实现是压缩列表，其结构与哈希对象类似，不同的是两个紧密相连的压缩列表节点，第一个保存元素的成员，第二个保存元素的权重，而且权重小的靠近表头，大的靠近表尾。
![image](https://user-images.githubusercontent.com/87458342/132522277-19141251-9509-4edc-8027-e2ecdc385b7b.png)

### 1.2 skiplist编码
- skiplist编码的有序集合对象底层实现是跳跃表和字典两种；
- 每个跳跃表节点都保存一个集合元素，并按权重从小到大排列；节点的object属性保存了元素的成员，score属性保存权重；
- 字典的每个键值对保存一个集合元素，字典的键保存元素的成员，字典的值保存权重。
![image](https://user-images.githubusercontent.com/87458342/132522391-e134841e-3548-4f54-8c49-bb3bc4d9492b.png)

### 1.3 为何skiplist编码要同时使用跳跃表和字典实现？
- 跳跃表优点是有序，但是查询权重复杂度为O(logn)；字典查询权重复杂度为O(1) ，但是无序，所以结合两个结构的有点进行实现。虽然采用两个结构但是集合的元素成员和权重是共享的，两种结构通过指针指向同一地址，不会浪费内存。
 
### 1.4 有序集合编码转换：
有序集合对象使用ziplist编码需要满足两个条件：
- 一是所有元素长度小于64字节；
- 二是元素个数小于128个；
不满足任意一条件将使用skiplist编码。以上两个条件可以在Redis配置文件中修改zset-max-ziplist-entries选项和zset-max-ziplist-value选项。
 
## 2 应用场景：
- 排行榜，取TopN操作。带权重的消息队列。
